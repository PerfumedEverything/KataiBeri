var m=Object.defineProperty;var f=(a,t,e)=>t in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var n=(a,t,e)=>f(a,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class v{constructor(){n(this,"selectors",{root:"[data-js-header]",overlay:"[data-js-header-overlay]",burgerButton:"[data-js-header-burger-button ]"});n(this,"stateClasses",{isActive:"is-active",isLock:"is-lock"});n(this,"onBurgerButtonClick",()=>{this.burgerButtonElement.classList.toggle(this.stateClasses.isActive),this.overlayElement.classList.toggle(this.stateClasses.isActive),document.documentElement.classList.toggle(this.stateClasses.isLock)});this.rootElement=document.querySelector(this.selectors.root),this.overlayElement=this.rootElement.querySelector(this.selectors.overlay),this.burgerButtonElement=this.rootElement.querySelector(this.selectors.burgerButton),this.bindEvents()}bindEvents(){this.burgerButtonElement.addEventListener("click",this.onBurgerButtonClick)}}class p{constructor(t,e=!1){this.root=t,this.root&&(this.list=this.root.querySelector("[data-js-slider-list]"),this.pagination=this.root.querySelector("[data-js-slider-pagination]"),this.isOptionsSlider=e,this.currentIndex=0,this.itemWidth=0,this.visibleItems=1,this.gap=0,this.isScrolling=!1,this.updateItems(),this.init(),this.observeDOM())}updateItems(){return this.items=[...this.root.querySelectorAll("[data-js-slider-item]")],!(!this.list||!this.items.length)}observeDOM(){new MutationObserver(()=>{this.updateItems()?(this.updateDimensions(),this.createPagination(),this.currentIndex=Math.min(this.currentIndex,Math.max(0,this.items.length-this.visibleItems)),this.scrollToCurrent(),this.updatePagination()):this.pagination&&(this.pagination.innerHTML="")}).observe(this.list,{childList:!0,subtree:!0})}init(){if(this.items.length){if(this.isOptionsSlider&&window.innerWidth>1024){this.list.scrollTo({left:0}),this.pagination&&(this.pagination.innerHTML="");return}this.updateDimensions(),this.createPagination(),this.updatePagination(),this.list.addEventListener("wheel",t=>{!t.shiftKey&&Math.abs(t.deltaY)>Math.abs(t.deltaX)||this.isScrolling||(this.isScrolling=!0,this.slide(t.deltaX>0||t.deltaY>0?"next":"prev"),setTimeout(()=>this.isScrolling=!1,300))}),this.list.addEventListener("touchstart",t=>{this.touchStartX=t.touches[0].clientX}),this.list.addEventListener("touchmove",t=>{this.touchEndX=t.touches[0].clientX}),this.list.addEventListener("touchend",()=>{if(this.isScrolling)return;const t=this.touchStartX-this.touchEndX;Math.abs(t)<50||(this.isScrolling=!0,this.slide(t>0?"next":"prev"),setTimeout(()=>this.isScrolling=!1,300))}),window.addEventListener("resize",()=>{if(this.isOptionsSlider&&window.innerWidth>1024){this.list.scrollTo({left:0}),this.pagination&&(this.pagination.innerHTML="");return}this.updateDimensions(),this.createPagination(),this.currentIndex=Math.min(this.currentIndex,Math.max(0,this.items.length-this.visibleItems)),this.scrollToCurrent(),this.updatePagination()})}}updateDimensions(){this.visibleItems=this.isOptionsSlider?1:window.innerWidth>1024?3:window.innerWidth>768?2:1,this.gap=parseInt(getComputedStyle(this.list).gap)||20,this.itemWidth=this.items[0]?this.items[0].getBoundingClientRect().width+this.gap:0}createPagination(){if(!this.pagination)return;this.pagination.innerHTML="";const t=this.isOptionsSlider?Math.ceil(this.items.length/this.visibleItems):Math.max(1,this.items.length-this.visibleItems+1);if(!(t<=1))for(let e=0;e<t;e++){const s=document.createElement("button");s.classList.add(this.isOptionsSlider?"options__slider-pagination-dot":"reviews__slider-pagination-dot"),s.type="button",s.setAttribute("aria-label",`Slide ${e+1}`),s.addEventListener("click",()=>{this.currentIndex=e,this.scrollToCurrent(),this.updatePagination()}),this.pagination.appendChild(s)}}slide(t){const e=this.isOptionsSlider?Math.ceil(this.items.length/this.visibleItems)-1:Math.max(0,this.items.length-this.visibleItems);this.currentIndex=t==="prev"?Math.max(0,this.currentIndex-1):Math.min(e,this.currentIndex+1),this.updateDimensions(),this.scrollToCurrent(),this.updatePagination()}scrollToCurrent(){this.items.length&&this.list.scrollTo({left:this.currentIndex*this.itemWidth,behavior:"smooth"})}updatePagination(){if(!this.pagination)return;const t=this.pagination.querySelectorAll(`.${this.isOptionsSlider?"options__slider-pagination-dot":"reviews__slider-pagination-dot"}`),e=this.isOptionsSlider?Math.ceil(this.items.length/this.visibleItems):Math.max(1,this.items.length-this.visibleItems+1);if(t.length!==e){this.createPagination();return}t.forEach((s,i)=>{s.classList.toggle("is-active",i===this.currentIndex),s.disabled=i===this.currentIndex})}}class y{constructor(){n(this,"selectors",{root:"[data-js-filters]",applyButton:".filters__apply-button",resetButton:".filters__reset-button",filterButton:".button-filters",productItem:".filters__catalog-item",categoryBlock:".filters__catalog-category",group:".filters__panel-group",showToggle:"[data-js-show-toggle]",noResults:"[data-js-no-results]"});n(this,"stateClasses",{active:"active",hidden:"is-hidden",visible:"is-visible",toggled:"is-toggled"});n(this,"maxVisibleItemsPerCategory",3);this.root=document.querySelector(this.selectors.root),this.root&&(this.isExpanded=!1,this.initElements(),this.initBindings(),this.bindEvents(),this.initShowMore())}initElements(){this.applyButton=this.root.querySelector(this.selectors.applyButton),this.resetButton=this.root.querySelector(this.selectors.resetButton),this.filterButtons=this.root.querySelectorAll(this.selectors.filterButton),this.productItems=this.root.querySelectorAll(this.selectors.productItem),this.categoryBlocks=this.root.querySelectorAll(this.selectors.categoryBlock),this.groups=this.root.querySelectorAll(this.selectors.group),this.showToggleButton=this.root.querySelector(this.selectors.showToggle),this.noResults=this.root.querySelector(this.selectors.noResults),this.activeFilters={location:null,categories:[]}}initBindings(){this.handleFilterClick=this.handleFilterClick.bind(this),this.applyFilters=this.applyFilters.bind(this),this.resetFilters=this.resetFilters.bind(this),this.handleShowToggle=this.handleShowToggle.bind(this)}bindEvents(){var t,e,s;this.filterButtons.forEach(i=>{i.addEventListener("click",this.handleFilterClick)}),(t=this.applyButton)==null||t.addEventListener("click",this.applyFilters),(e=this.resetButton)==null||e.addEventListener("click",this.resetFilters),(s=this.showToggleButton)==null||s.addEventListener("click",this.handleShowToggle)}initShowMore(){this.updateVisibility(),this.updateToggleButton()}handleShowToggle(t){t.preventDefault(),this.isExpanded=!this.isExpanded,this.updateVisibility(),this.updateToggleButton()}updateVisibility(){let t=0;this.categoryBlocks.forEach(e=>{const s=e.dataset.filterCategory.split(" "),i=e.querySelectorAll(this.selectors.productItem);let o=0;const l=this.activeFilters.categories.length===0||s.some(r=>this.activeFilters.categories.includes(r));i.forEach((r,c)=>{const h=r.dataset.location.split(" "),d=!this.activeFilters.location||h.includes(this.activeFilters.location),u=l&&d&&(this.isExpanded||c<this.maxVisibleItemsPerCategory);r.classList.toggle(this.stateClasses.hidden,!u),r.classList.toggle(this.stateClasses.visible,u),u&&(o++,t++)}),e.classList.toggle(this.stateClasses.hidden,o===0)}),this.noResults&&(this.noResults.classList.toggle(this.stateClasses.hidden,t>0),this.noResults.classList.toggle(this.stateClasses.visible,t===0)),this.showToggleButton&&this.showToggleButton.classList.toggle(this.stateClasses.hidden,t===0)}updateToggleButton(){if(!this.showToggleButton)return;const t=Array.from(this.productItems).filter(e=>{const s=e.dataset.location.split(" "),o=e.closest(this.selectors.categoryBlock).dataset.filterCategory.split(" "),l=!this.activeFilters.location||s.includes(this.activeFilters.location),r=this.activeFilters.categories.length===0||o.some(c=>this.activeFilters.categories.includes(c));return l&&r}).length;this.showToggleButton.classList.toggle(this.stateClasses.toggled,this.isExpanded),this.showToggleButton.classList.toggle(this.stateClasses.hidden,t<=this.maxVisibleItemsPerCategory*this.categoryBlocks.length||t===0)}handleFilterClick(t){const e=t.currentTarget,s=e.closest(this.selectors.group);(e.dataset.filter.startsWith("location")?"location":"category")==="location"?this.handleLocationFilter(e,s):this.handleCategoryFilter(e,s)}handleLocationFilter(t,e){const s=t.dataset.filter==="all";e.querySelectorAll(this.selectors.filterButton).forEach(i=>i.classList.remove(this.stateClasses.active)),t.classList.add(this.stateClasses.active),this.activeFilters.location=s?null:t.dataset.filter}handleCategoryFilter(t,e){var i;t.dataset.filter==="all"?(e.querySelectorAll(this.selectors.filterButton).forEach(o=>o.classList.remove(this.stateClasses.active)),t.classList.add(this.stateClasses.active)):((i=e.querySelector('[data-filter="all"]'))==null||i.classList.remove(this.stateClasses.active),t.classList.toggle(this.stateClasses.active))}applyFilters(){this.updateActiveFilters(),this.isExpanded=!1,this.updateVisibility(),this.updateToggleButton()}updateActiveFilters(){var s;const t=this.root.querySelector('[data-filter^="location-"].active, [data-filter="all"].active');this.activeFilters.location=(t==null?void 0:t.dataset.filter)==="all"?null:t==null?void 0:t.dataset.filter;const e=(s=this.root.querySelector(`${this.selectors.group} [data-filter^="category-"]`))==null?void 0:s.closest(this.selectors.group);e.querySelector('[data-filter="all"].active')?this.activeFilters.categories=[]:this.activeFilters.categories=Array.from(e.querySelectorAll(".active")).map(i=>i.dataset.filter)}resetFilters(){this.groups.forEach(t=>{var e;t.querySelectorAll(this.selectors.filterButton).forEach(s=>s.classList.remove(this.stateClasses.active)),(e=t.querySelector('[data-filter="all"]'))==null||e.classList.add(this.stateClasses.active)}),this.activeFilters={location:null,categories:[]},this.isExpanded=!1,this.updateVisibility(),this.updateToggleButton()}}class b{constructor(){n(this,"selectors",{root:"[data-js-filters-panel]",overlay:".filters__panel-overlay",toggleButton:".filters__panel-header-btn"});n(this,"stateClasses",{isActive:"is-active"});n(this,"onToggleClick",()=>{this.toggleButton.classList.toggle(this.stateClasses.isActive),this.overlayElement.classList.toggle(this.stateClasses.isActive),document.querySelector(this.selectors.lockElement)});this.rootElement=document.querySelector(this.selectors.root),this.overlayElement=this.rootElement.querySelector(this.selectors.overlay),this.toggleButton=this.rootElement.querySelector(this.selectors.toggleButton),this.bindEvents()}bindEvents(){this.toggleButton.addEventListener("click",this.onToggleClick)}}class C{constructor(){n(this,"selectors",{popups:"[data-popup]",forms:"[data-form]",openButtons:"[data-popup-open]",closeButton:"[data-popup-close]",headerContent:"[data-form-header]",inputs:"[data-form-inputs]",inputFields:"[data-form-inputs] input",successMessage:"[data-form-success]",submitButton:"[data-form-submit]",homeButton:"[data-form-home]",agreement:"[data-form-agreement]",formButton:".form-button"});n(this,"stateClasses",{isActive:"is-active",isLock:"is-lock",hidden:"is-hidden",visible:"is-visible"});this.popups=document.querySelectorAll(this.selectors.popups),this.forms=document.querySelectorAll(this.selectors.forms),this.openButtons=document.querySelectorAll(this.selectors.openButtons),console.log("Popups found:",this.popups.length),console.log("Forms found:",this.forms.length),this.bindEvents()}bindEvents(){this.openButtons.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const s=t.dataset.popupOpen==="want-to-ride"?"want-to-ride-popup":"rent-popup",i=document.getElementById(s);if(!i){console.warn(`Popup with ID ${s} not found`);return}this.openPopup(i)})}),this.popups.forEach(t=>{const e=t.querySelector(this.selectors.closeButton);e==null||e.addEventListener("click",()=>this.closePopup(t)),t.addEventListener("click",s=>{s.target===t&&this.closePopup(t)})}),this.forms.forEach(t=>{t.addEventListener("submit",e=>this.handleFormSubmit(e,t))})}openPopup(t){t.classList.add(this.stateClasses.isActive),document.documentElement.classList.add(this.stateClasses.isLock)}closePopup(t){t.classList.remove(this.stateClasses.isActive),document.documentElement.classList.remove(this.stateClasses.isLock);const e=t.querySelector(this.selectors.forms),s=t.querySelector(this.selectors.headerContent),i=t.querySelector(this.selectors.inputs),o=t.querySelectorAll(this.selectors.inputFields),l=t.querySelector(this.selectors.successMessage),r=t.querySelector(this.selectors.submitButton)||t.querySelector(this.selectors.formButton),c=t.querySelector(this.selectors.homeButton),h=t.querySelector(this.selectors.agreement);e==null||e.reset(),s&&(s.classList.remove(this.stateClasses.hidden),s.classList.add(this.stateClasses.visible)),i&&(i.classList.remove(this.stateClasses.hidden),i.classList.add(this.stateClasses.visible)),o.forEach(d=>d.removeAttribute("disabled")),l&&(l.classList.add(this.stateClasses.hidden),l.classList.remove(this.stateClasses.visible)),r&&(r.classList.remove(this.stateClasses.hidden),r.classList.add(this.stateClasses.visible)),c&&(c.classList.add(this.stateClasses.hidden),c.classList.remove(this.stateClasses.visible)),h&&(h.classList.remove(this.stateClasses.hidden),h.classList.add(this.stateClasses.visible))}handleFormSubmit(t,e){t.preventDefault();const s=e.querySelector(this.selectors.headerContent),i=e.querySelector(this.selectors.inputs),o=e.querySelectorAll(this.selectors.inputFields),l=e.querySelector(this.selectors.successMessage),r=e.querySelector(this.selectors.submitButton)||e.querySelector(this.selectors.formButton),c=e.querySelector(this.selectors.homeButton),h=e.querySelector(this.selectors.agreement),d=e.closest(this.selectors.popups);console.log("Form submitted:",e),console.log("Is popup form:",!!d),console.log("Header content found:",s),console.log("Inputs found:",i),console.log("Input fields found:",o.length),console.log("Agreement found:",h),console.log("Success message found:",l),console.log("Submit button found:",r),console.log("Form data:",new FormData(e)),s&&(s.classList.add(this.stateClasses.hidden),s.classList.remove(this.stateClasses.visible)),i&&(i.classList.add(this.stateClasses.hidden),i.classList.remove(this.stateClasses.visible),d||o.forEach(g=>g.setAttribute("disabled","true"))),h&&(h.classList.add(this.stateClasses.hidden),h.classList.remove(this.stateClasses.visible)),l&&(l.classList.remove(this.stateClasses.hidden),l.classList.add(this.stateClasses.visible)),r&&(r.classList.add(this.stateClasses.hidden),r.classList.remove(this.stateClasses.visible)),c&&(c.classList.remove(this.stateClasses.hidden),c.classList.add(this.stateClasses.visible))}}class L{constructor(){if(this.mapContainer=document.querySelector("#yandex-map"),!this.mapContainer)return;const t=new IntersectionObserver(e=>{e[0].isIntersecting&&(this.loadYandexMapAPI(),t.disconnect())});t.observe(this.mapContainer)}loadYandexMapAPI(){const t=document.createElement("script");t.src="https://api-maps.yandex.ru/2.1/?lang=ru_RU",t.async=!0,t.onload=()=>ymaps.ready(()=>this.initMap()),document.head.appendChild(t)}initMap(){this.myMap=new ymaps.Map(this.mapContainer,{center:[48.7326,44.5432],zoom:12,controls:["zoomControl"]}),[{coords:[48.7326,44.5432],label:"ЦПКиО",description:"Пн-Пт: 9:00-19:00<br>Сб-Вс: 9:00-21:00"},{coords:[48.7028,44.5295],label:"Чуйкова",description:"Пн-Пт: 9:00-19:00<br>Сб-Вс: 9:00-21:00"}].forEach(s=>{const i=new ymaps.Placemark(s.coords,{balloonContent:`<strong>${s.label}</strong><br>${s.description}`},{preset:"islands#redDotIcon"});this.myMap.geoObjects.add(i)});const e=document.querySelectorAll(".map__aside-container");e.forEach(s=>{s.addEventListener("click",()=>{e.forEach(l=>l.classList.remove("active")),s.classList.add("active");const i=parseFloat(s.dataset.lat),o=parseFloat(s.dataset.lon);this.myMap.setCenter([i,o],15,{duration:300})})}),e.length>0&&e[0].classList.add("active")}}document.addEventListener("DOMContentLoaded",()=>{document.querySelector("[data-js-header]")&&new v;const a=document.querySelector(".options-slider[data-js-slider]");a&&new p(a,!0);const t=document.querySelector(".reviews__slider[data-js-slider]");t&&new p(t,!1),document.querySelector("[data-js-filters]")&&new y,document.querySelector("[data-js-filters-panel]")&&new b,new C,new L});
